<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xforms="http://www.w3.org/2002/xforms"
      xmlns:xxforms="http://orbeon.org/oxf/xml/xforms"
      xmlns:ev="http://www.w3.org/2001/xml-events"
      xmlns:fr="http://orbeon.org/oxf/xml/form-runner"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:atom="http://www.w3.org/2005/Atom">
    <head>
        <title>dataMerger - Exports</title>
        <xforms:model id="mod-exports">

        	<!-- View exports -->
            <xforms:instance id="ins-exports">
                <atom:feed/>
            </xforms:instance>
			<xforms:submission
				id="get-exports"
				resource="/service/content/exports"
				method="get"
				replace="instance"
				instance="ins-exports">

                <xforms:message ev:event="xforms-submit-error" level="modal">An error occurred (<xforms:output value="event('error-type')"/>) while retrieving the exports.</xforms:message>
			</xforms:submission>
			<xforms:send ev:event="xforms-model-construct-done" submission="get-exports"/>
			
        </xforms:model>
    </head>
    <body>
    <div class="page">
    	<xi:include href="../common/includes/header.xml"/>
    	<h2 class="page-title">Exports</h2>

	
		<xforms:group ref="instance('ins-exports')[not(exists(atom:entry))]">
    		<p>You have no exports.</p>
    	</xforms:group>
    	
    	<xforms:group ref="instance('ins-exports')[exists(atom:entry)]">

		    	<fr:datatable>
		    		<thead>
		    			<tr>
		    				<th fr:sortable="true" fr:resizeable="false">ID</th>
		    				<th fr:sortable="true" fr:resizeable="true">File 1</th>
		    				<th fr:sortable="true" fr:resizeable="true">File 2</th>
		    				<th><!-- Column for edit join links --></th>
		    				<th><!-- Column for edit resolution links --></th>
		    				<th fr:sortable="true" fr:resizeable="true">Created</th>
		    				<th><!-- Column for download links --></th>
		    			</tr>
		    		</thead>
		    		<tbody>
		    			<xforms:repeat id="rep-exports" nodeset="xxforms:sort(instance('ins-uploads')/atom:entry, atom:published, 'text', 'ascending')">
		    			
		    				<tr>
		    					<td>
									[ID]
		    					</td>
		    					<td>
		    						[&lt;Filename 1 (ID)&gt;]
		    					</td>
		    					<td>
		    						[&lt;Filename 2 (ID)&gt;]
		    					</td>
		    					<td>
		    						[&lt;Join&gt;]
		    					</td>
		    					<td>
		    						[&lt;Resolutions&gt;]
		    					</td>
		    					<td>
		    						<xforms:output ref="atom:published" xxforms:format="format-dateTime(., '[D01] [MNn,*-3] [Y0001]')"/>
		    					</td>
		    					<td>
									[&lt;Download&gt;]
		    					</td>	
		    				</tr>
		    			</xforms:repeat>
		    		</tbody>
		    	</fr:datatable>

	    </xforms:group>
	    

	    
	    
	</div>
    </body>
</html>
